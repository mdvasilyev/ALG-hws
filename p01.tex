\section{BFS}

% \subsection{Практика}
% \begin{enumerate}

%   \item
%     Даны три бочки на 10, 7 и 4 литра. 7- и 4-литровые бочки
%     заполнены водой.  Разрешается переливать воду между бочками, 
%     либо пока одна бочка не заполнится полностью, либо пока 
%     другая не опустеет. Проверить, можно ли получить 2 литра в любой из бочек. 
%     Если возможно, найти минимальное необходимое число переливаний.  
%     Как решить аналогичную задачу, если емкости бочек $a$, $b$
%     и $c$ ($a, b, c \in \mathbb{N}, \, a \leq b \leq c$), а бочки с ёмкостями $a$ и $b$ заполнены
%     водой? Время: $\O(a \cdot b)$.

%   \item
%     Найти количество путей (необязательно простых) в графе за $\O(V^3 \log{k})$
%     \begin{enumerate}
%     	\item между всеми парами вершин длины ровно $k$.
%     	\item между парой вершин длины $\le k$.
%     \end{enumerate}

%   \item
% 	  Найти в орграфе все вершины, через которые проходит какой-нибудь кратчайший путь $a \leadsto b$. $\O(V + E)$.

%   \item
%     Пусть в графе есть ребра веса $0$ и $1$. Придумайте, как найти
%     кратчайшее расстояние от вершины $s$ до остальных за $\O(V + E)$.

%   \item
%     Пусть в графе все ребра имеют целый вес из $[1, k]$. Придумайте, как найти
%     кратчайшее расстояние от вершины $s$ до остальных.
%     \begin{enumerate}
%       \item $k = 2$, $\O(V + E)$
%       \item $k$ --- произвольное, $\O(V + kE)$.
%       \item $k$ --- произвольное, $\O(k V + E)$.
%       \item $k$ --- произвольное, $\O(E \log{k})$.
%     \end{enumerate}

%   \item
%     Дан орграф с положительными весами на ребрах. Найти кратчайший путь, проходящий по всем $k$ выделенным вершинам. 
%     Время $\O(2^k E \log{(2^k V)})$.

% \subsection*{Дополнительные задачи}

%   \item
% 	Пусть длина пути определяется как сумма весов всех ребер по модулю $n$.
% 	Найти кратчайший путь за $\O((V+E)n)$.

%   \item
%     В стране $n$ аэропортов. Самолет может сделать перелет 
%     из аэропорта $i$ в аэропорт $j$, израсходовав $w_{ij} > 0$ горючего.
%     При этом $w_{ij}$ может отличаться от $w_{ji}$, и $w_{ii} = 0$.
% 	Требуется найти минимальный размер бака, позволяющий добраться
% 	самолету из любого города в любой, возможно с дозаправками.
% 	Решить за $\O(n^2)$.

%   \item
%     \begin{enumerate}
%       \item $k$-$2k$-bfs, веса вещественные.
%       \item $k$-$2k$-bfs, веса целые, хотим делать только целочисленные операции.
%     \end{enumerate}

%   \item
% 	Даны две параллельных прямых (река). В реке есть $n$ островов (точек). Мы хотим провести по
% 	реке корабль, представляющий собой открытый круг радиуса $R$, так, чтобы он не задел ни одного острова.
% 	Найти максимальный $R$, при котором это еще возможно, за $\O(n^2)$.

% \end{enumerate}

% \pagebreak

\subsection{Домашнее задание}
\begin{enumerate}
  \item
    Дан взвешенный орграф с положительными весами и вершина $s$.
    Нужно для каждой вершины $v$ найти число кратчайших путей из $s$ в $v$ по модулю $p$. $\O(E \log V)$.

  \item
    В орграфе есть бесплатные и $K$ типов платных ребер. Передвижение
    по любому ребру стоит $0$, но, чтобы двигаться по платному ребру
    типа $x$, необходимо иметь пропуск того же типа. В любой момент
    времени можно иметь не более одного пропуска, однако в любой
    вершине есть возможность купить пропуск любого типа за $A$ и
    продать пропуск любого типа за $B$ ($0 < B < A$, цены одинаковы
    во всех вершинах). Найдите самый дешевый способ добраться из вершины
    $s$ до вершины $t$ за $\O(K (V + E))$.

  \item
    Дан ориентированный граф с выделенными вершинами $s$ и $t$. Перемещение по любому ребру занимает 1 единицу времени.
    В начальный момент времени мы стоим в вершине $s$, и во все ребра с постоянной скоростью $L$ начинает поступать вода.
    У каждого ребра $e$ есть емкость $C_e$ --- минимальное количество воды в этом ребре, при котором по нему больше
    нельзя двигаться (мы должны закончить движение по ребру не позднее момента достижения его емкости). Найдите
    максимальное $L$, при котором все еще существует возможность добраться от $s$ до $t$ за $\O((V + E)\log{C_{\max}})$.

  \item
    Постройте матрицу $n \times n$, состоящую из клеток-стенок и пустых клеток,
    на которой при запуске \texttt{BFS} из какой-то клетки максимальный
    размер очереди будет $\omega(n)$. Ходить можно между клетками, смежными по стороне.

  \item
    Попробуем научить алгоритм Дейкстры работать на графах с отрицательными весами: вынимаем из кучи вершину $v$
    с минимальным расстоянием и релаксируем все ребра из $v$. При этом вершины, до которых улучшилось расстояние,
    добавляются в кучу (или делается \texttt{DecreaseKey}, если вершина уже там).
    \begin{enumerate}
      \item Покажите, что этот алгоритм корректно вычисляет кратчайшие пути, если нет циклов отрицательного веса.
      \item Придумайте пример без циклов отрицательного веса, на котором время работы экспоненциально.
    \end{enumerate}

\subsection*{Дополнительные задачи}

  \item
    Модифицируем условия задачи про бочки: есть $n$ бочек, $i$-я бочка имеет
    объем $v_i$ ($v_i > 0$) и в начальный момент содержит $c_i$ воды
    ($0 \le c_i \le v_i$). Операция переливания определена как в задаче из практики.
    Придумайте такие $n$ и вещественные $v_i$, $c_i$, чтобы соответствующий граф
    состояний, достижимых с помощью переливаний из начального, получился бесконечным.  

\end{enumerate}
