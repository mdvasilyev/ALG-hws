\section{Асимптотика}
\begin{enumerate}
  \item	
	Эквивалентны ли следующие факты?
	\begin{itemize}
		\item $f = \Theta(g)$
		\item $\exists C,  0 < C < \infty : \lim\limits_{n \to \infty} \frac{f(n)}{g(n)} = C$
	\end{itemize}

  \begin{proof}

    Из $f = \Theta(g)$ не следует, что $\exists C,  0 < C < \infty : \lim\limits_{n \to \infty} \frac{f(n)}{g(n)} = C$.
    Например, пусть $f(n)$ и $g(n)$ -- некоторые положительные функции. Возьмем
    \begin{equation}
      f(n) = (\sin(n) + 2)\cdot g(n), \qquad -1 < \sin(n) < 1 \quad \forall n \in \N.
    \end{equation}
    Если $f = \Theta(g)$ для всех $n$, то предел их отношения при таком задании $f(n)$ не сходится к какой-нибудь константе:
    \begin{equation}
      \lim\limits_{n \to \infty} \frac{f(n)}{g(n)} = \lim\limits_{n \to \infty} \frac{(\sin(n) + 2)\cdot g(n)}{g(n)} = 2 + \lim\limits_{n \to \infty} \sin(n) = ?
    \end{equation}
    Если хотя бы в одну сторону следствие не работает, то можно сказать, что утверждения не эквивалентны.

    % По определению из лекции:
    % \begin{eqnarray}
    %   f(n) = \Theta(g(n)), \text{ если } f(n) = \O(g(n)) \text{ и } g(n) = \O(f(n)), \\
    %   f(n) = \O(g(n)), \text{ если } \exists C > 0, N \in \N: \forall n \geq N \quad f(n) \leq C \cdot g(n), \\
    %   g(n) = \O(f(n)), \text{ если } \exists C > 0, N \in \N: \forall n \geq N \quad g(n) \leq C \cdot f(n).
    % \end{eqnarray}
    % Таким образом, мы имеем систему:
    % \begin{equation}
    %   \begin{cases}
    %     f(n) \leq C_1 \cdot g(n), \\
    %     g(n) \leq C_2 \cdot f(n),
    %   \end{cases}
    % \end{equation}
    % где первое уравнение выполняется с некоторого $n_1$, а второе с некоторого $n_2$. Так как $f$ и $g$ отображают в положительные числа, то можем поделить без смены знака неравенства:
    % \begin{equation}
    %   \begin{cases}
    %     \dfrac{f(n)}{g(n)} \leq C_1, \\ \qquad\qquad\qquad\qquad\qquad\Rightarrow\\
    %     \dfrac{f(n)}{g(n)} \geq C_2.
    %   \end{cases}
    % \end{equation}
    % Следовательно,
    % \begin{equation}\label{eq:doubleIneq}
    %   C_2 \leq \dfrac{f(n)}{g(n)} \leq C_1.
    % \end{equation}
    % Устремим $n$ к бесконечности. Из (\ref{eq:doubleIneq}) видно, что отношение функций стремится к некоторой константе $C_3$:
    % \begin{equation}
    %   C_2 \leq C_3 \leq C_1.
    % \end{equation}
    % То есть:
    % \begin{equation}
    %   f = \Theta(g) \Rightarrow \exists C,  0 < C < \infty : \lim\limits_{n \to \infty} \frac{f(n)}{g(n)} = C.
    % \end{equation}
    % \textit{В обратную сторону}: если
    % \begin{equation}
    %   \exists C,  0 < C < \infty : \lim\limits_{n \to \infty} \frac{f(n)}{g(n)} = C,
    % \end{equation}
    % то, при $n \to \infty$, $f(n) \to C \cdot g(n)$, но
    % \begin{equation}
    %   f(n) = \O(f(n)) = \O(C \cdot g(n)) = \O(g(n)).
    % \end{equation}
    % Также, из $\exists C,  0 < C < \infty : \lim\limits_{n \to \infty} \dfrac{f(n)}{g(n)} = C$, можно сказать, что, при $n \to \infty$, $g(n) \to \dfrac{1}{C}f(n)$, но
    % \begin{equation}
    %   g(n) = \O(g(n)) = \O\left(\dfrac{1}{C}f(n)\right) = \O(f(n)).
    % \end{equation}
    % Имеем, что
    % \begin{equation}
    %   f(n) = \O(g(n)) \quad \text{и} \quad g(n) = \O(f(n)),
    % \end{equation}
    % из чего следует, что
    % \begin{equation}
    %   f(n) = \Theta(g(n)).
    % \end{equation}
    % Получилось, что исходные утверждения эквивалентны.
  \end{proof}

  \item
    Дайте ответ для двух случаев $\mathbb{N} \to \mathbb{N}$ и $\mathbb{N} \to \mathbb{R}_{>0}$:
    \begin{enumerate}
      \item
        Если в определении $\O$ опустить условие про $N$ (т.е. оставить
        просто $\forall n$), будет ли полученное определение эквивалентно исходному?

      \begin{proof}
        Хотим доказать, что, если $f, g: \N \to \N$, то:
        \begin{equation}
          \exists C > 0, N \in \N: \forall n \geq N \quad f(n) \leq C \cdot g(n) \Leftrightarrow \exists C > 0: \forall n \quad f(n) \leq C \cdot g(n).
        \end{equation}
        \textit{В одну сторону}:
        Если мы в первом случае подобрали такие константы $C_0$ и $N_0$, что, начиная с некоторого $n \geq N_0$ неравенство $f(n) \leq C_0 \cdot g(n)$ будет выполняться, то это никак не противоречит тому, что мы можем подобрать такую константу $C_0'$, что неравенство $f(n) \leq C_0' \cdot g(n)$ будет выполняться для всех $n \in \N$ (здесь я очень надеюсь, что в натуральные числа ноль не входит). Как это можно сделать: зная, что $f, g: \in \N$, выбираем $C_0'$ как
        \begin{equation} \label{eq:c0'}
          C_0' = \frac{f(n)}{g(n)} + 1.
        \end{equation}

        \textit{В другую сторону}:
        Если мы подобрали такую константу $C_0'$, что неравенство $f(n) \leq C_0' \cdot g(n)$ будет выполняться для всех $n \in \N$, то из этого следует, что мы можем подобрать такую константу $C_0$ (например, равную $C_0'$) и $N_0$, что неравенство $f(n) \leq C_0 \cdot g(n)$ будет выполняться с некоторого $n \geq N_0$.

        Теперь рассмотрим случай, когда $f, g: \N \to \mathbb{R}_{>0}$. Здесь нужно понимать, что значения функций могут уходить в 0, поэтому производить деление как в~(\ref{eq:c0'}) опасно. Но опять же, \textit{в одну сторону}: если мы в первом случае подобрали такие константы $C_0$ и $N_0$, что, начиная с некоторого $n \geq N_0$ неравенство $f(n) \leq C_0 \cdot g(n)$ будет выполняться, то это никак не противоречит тому, что мы можем подобрать такую константу $C_0'$, что неравенство $f(n) \leq C_0' \cdot g(n)$ будет выполняться для всех $n \in \N$ при всех комбинациях бесконечно малости и бесконечно большести функций $f(n), g(n)$. \textit{В другую сторону}: если выполнено для всех, но для всех, начинающихся с некоторого номера, тоже выполнено.



        % \begin{equation}
        %   f(n) = \O(g(n)), \quad \text{если } \quad \exists C > 0, N \in \N: \forall n \geq N \quad f(n) \leq C \cdot g(n)
        % \end{equation}
        % Рассмотрим случай, когда отображение $\N \to \N$. Если опустить условие про $N$, то определения останутся эквивалентными, потому что в конечном итоге мы будем иметь неравенство:
        % \begin{equation}
        %   f(n) \leq C \cdot g(n),
        % \end{equation}
        % которое просто сводится к
        % \begin{equation}
        %   C_1 \leq C \cdot C_2,
        % \end{equation}
        % где $C_1, C_2 \in \N$. Очевидно, что мы всегда можем подобрать такую $C$, чтобы неравенство выполнялось, например:
        % \begin{equation}
        %   C = \dfrac{C_1}{C_2} + 1.
        % \end{equation}
        % Если отображение $\N \to \mathbb{R}_{>0}$, то:
        % \begin{equation}
        %   C_1' \leq C \cdot C_2',
        % \end{equation}
        % где $C_1', C_2' \in \mathbb{R}_{>0}$. Если $C_1, C_2$ -- бесконечно малые (или бесконечно большие), $C$ можно легко подобрать. Если $C_1$ -- бесконечно большая, а $C_2$ -- бесконечно малая, то $C$ можно взять как бесконечно большую более высокого порядка по сравнению с $\frac{C_1}{C_2}$.

        % Так как $C$ всегда можно найти, то определение без конкретного $N$ оказывается эквивалентным исходному.
      \end{proof}
      \item Тот же вопрос про $o$.
      
      Правильно выпишем определение:
      \begin{equation}
        f(n) = o(g(n)), \quad \text{если } \quad \forall C > 0: \exists N \in \N: \forall n \geq N \quad f(n) < C \cdot g(n)
      \end{equation}
      о малое означает, что в данном случае $f$ будет бесконечно малой по отношению к $g$, т.е.:
      \begin{equation}
        \dfrac{f(n)}{g(n)} < C.
      \end{equation}
      Ну а так как $C$ -- любое, то и оно может быть сколь угодно маленьким, и в пределе давать отношение функций, которое стремится к нулю:
      \begin{equation}
        \lim\limits_{n\to\infty}\dfrac{f(n)}{g(n)} \to 0.
      \end{equation}
      Поэтому ограничение на $n$ здесь несущественно, поэтому его можно опустить. Тогда определения будут эквивалентными.
      % В случае с o, функция $f$ трактуется как бесконечно малая по отношению к функции $g$:
      % \begin{equation}
      %   \lim\limits_{n \to \infty} \frac{f(n)}{g(n)} = 0,
      % \end{equation}
      % то есть на бесконечности функция $g$ строго превосходит функцию $f$.
      % В данном случае неравенства будут строгими, но, делая те же самые рассуждения, которые были сделаны в пункте (a), можно понять, что $C$ тоже всегда удастся подобрать.
    \end{enumerate}

  \item[5.]
    Продолжим отношение ``$\preceq$'' на функциях до отношения на классах эквивалентности по отношению эквивалентности ``$\sim$'', введённому на практике. Правда ли, что получится отношение \textit{линейного порядка} (то есть
    $\forall f, g: (f \preceq g) \lor (g \preceq f)$)?
    \begin{proof}
      Линейный порядок означает, что какие бы функции $f, g$ мы не взяли, для них всегда выполняется следующее отношение:
      \begin{equation} \label{eq:rel}
        (f \preceq g) \lor (g \preceq f).
      \end{equation}
      Вспомним, какие отношения у нас есть:
      \begin{equation}\label{eq:rels}
        \O, \quad o, \quad \Theta, \quad \Omega, \quad \omega.
      \end{equation}
      Рассмотрим
      \begin{equation}
        \begin{cases}
          f(n) = n, \\
          g(n) = n^{\sin(n)}.
        \end{cases}
      \end{equation}
      В случае таких функций мы не можем задать на них никакое отношение из~(\ref{eq:rels}). Потому что даже при большой константе $C$ и больших номерах $n$ синус, отображающий в отрезок $[-1,1]$, будет либо максимально прижимать к нулю, либо выдавать большое значение. В общем, отношения задать не получится.
      % Нет, не правда. Эквивалентность $f \sim g$ означает, что функции $f$ и $g$ асимптотически имеют одинаковую скорость роста. При этом, такое поведение можно гарантировать, если одновременно выполнены два условия: $(f \preceq g)$ и $(g \preceq f)$. В математических терминах это можно записать через пересечение:
      % \begin{equation}
      %   \forall f, g: (f \preceq g) \land (g \preceq f).
      % \end{equation}
      % Если бы мы оставили объединение, то мы бы получили положительный ответ (что $f \sim g$), даже если только одно из утверждений ($(f \preceq g)$ или $(g \preceq f)$) было бы верным, ну а это неправда.
      
      % Пример:
      % \begin{equation}
      %   f(n) = 1, \quad \text{а} \quad g(n) = n.
      % \end{equation}
      % Видно, что следующее утверждение верно:
      % \begin{equation}
      %   (1 \preceq n) \lor (n \preceq 1),
      % \end{equation}
      % но утверждение
      % \begin{equation}
      %   1 \sim n
      % \end{equation}
      % неверное.
    \end{proof}

  \item[6.]
    Докажите, или приведите контрпример:
    \begin{enumerate}
      \item $g(n) = o(f(n)) \Rightarrow f(n) + g(n) = \Theta(f(n))$
      \begin{proof}
        \begin{equation}
          g(n) = o(f(n)), \quad \text{если } \quad \forall C > 0: \exists N \in \N: \forall n \geq N \quad g(n) < C \cdot f(n).
        \end{equation}
        Сумму функций можно переписать:
        \begin{equation}
          f(n) + g(n) = f(n) + o(f(n)).
        \end{equation}
        Но, из определения о малого, такая сумма не превосходит функцию $f$, умноженную на константу:
        \begin{equation}
          f(n) + o(f(n)) < f(n) + C \cdot f(n) = C' \cdot f(n).
        \end{equation}
        Очевидно, что какая-нибудь функция $h(n)$ имеет такую же скорость роста, как и она сама, то есть:
        \begin{equation}
          h(n) = \Theta(h(n)).
        \end{equation}
        Сделаем те же рассуждения для полученной ранее функции $C' \cdot f(n)$:
        \begin{equation}
          C' \cdot f(n) = \Theta(C' \cdot f(n)).
        \end{equation}
        Константу можно убрать:
        \begin{equation}
          \Theta(C' \cdot f(n)) = \Theta(f(n)).
        \end{equation}
        Проследив за цепочкой рассуждений, можно понять, что мы доказали следующий факт:
        \begin{equation}
          f(n) + g(n) = \Theta(f(n)), \quad \text{если} \quad g(n) = o(f(n)).
        \end{equation}

        % Ограничим снизу:
        % \begin{equation}
        %   f(n) + g(n) > g(n) + \frac{1}{C} \cdot g(n) = (\frac{1}{C} + 1) \cdot g(n) = \O(g(n)).
        % \end{equation}
        % Получается, что сумма $f(n) + g(n)$ в диапазоне:
        % \begin{equation}
        %   \O(g(n)) < f(n) + g(n) < \O(f(n)).
        % \end{equation}
        % Можно сделать вывод, что, действительно,
        % \begin{equation}
        %   f(n) + g(n) = \Theta(f(n)),
        % \end{equation}
        % т. е. сумма имеет одинаковую скорость роста с доминирующей функцией.
      \end{proof}
      \item $f(n) = \O(g(n)) \Leftrightarrow f(n) = o(g(n)) \lor f(n) = \Theta(g(n))$
      \begin{proof}
        Думал что-то такое привести в качестве контрпримера, но не знаю, времени не хватило доделать это все.
        \begin{equation}
          \begin{cases}
            f(n) = (2 + (-1)^n)\cdot n, \\
            g(n) = n.
          \end{cases}
        \end{equation}
        Посмотрим варианты для $f(n)$:
        \begin{equation}
          \begin{cases}
            f(n) = 3\cdot n, \quad \text{n четные}, \\
            f(n) = 2\cdot n, \quad \text{n нечетные}.
          \end{cases} 
        \end{equation}
        В данном случае
        \begin{equation}
          f(n) = \O(g(n)).
        \end{equation}
        Но из этого\dots\textcolor{gray}{[недописано]}
        % \begin{eqnarray}
        %   \lim\limits_{n \to \infty}{\dfrac{\sqrt{n}}{n^{\sin n}}} = ?,
        % \end{eqnarray}
        % Выпишем определения:
        % \begin{eqnarray}
        %   f(n) = \O(g(n)), \quad \text{если } \quad \exists C > 0, N \in \N: \forall n \geq N \quad f(n) \leq C \cdot g(n), \\
        %   f(n) = o(g(n)), \quad \text{если } \quad \exists C > 0, N \in \N: \forall n \geq N \quad f(n) < C \cdot g(n), \\
        %   f(n) = \Theta(g(n)) , \quad \text{если } \quad f(n) = \O(g(n)) \quad \text{и} \quad g(n) = \O(f(n)).
        % \end{eqnarray}
        % Утверждение (b) можно прочитать следующим образом: фраза ``функция $f$ растет не быстрее функции $g$'' эквивалента фразе ``функция $f$ или бесконечно малая относительно $g$, или имеет такую же скорость роста, как $g$''. Или в математических терминах:
        % \begin{equation}
        %   f \preceq g \Leftrightarrow (f \prec g) \lor (f \sim g).
        % \end{equation}
        % \textit{В одну сторону}: если известно, что функция $f$ растет не быстрее, чем функция $g$, то это означает, что $f$ либо строго меньше $g$, либо равна $g$:
        % \begin{equation}
        %   f \preceq g \Rightarrow (f \prec g) \lor (f \sim g).
        % \end{equation}
        % \textit{В обратную сторону}: если известно, что функция $f$ или строго меньше функции $g$, или равна $g$, то это означает, что не превосходит (меньше либо равна) $g$:
        % \begin{equation}
        %   (f \prec g) \lor (f \sim g) \Rightarrow f \preceq g.
        % \end{equation}
        % Так как было проведено доказательство в обе стороны, то можно ввести эквивалентность устверждений:
        % \begin{equation}
        %   f \preceq g \Leftrightarrow (f \prec g) \lor (f \sim g).
        % \end{equation}
      \end{proof}
    \end{enumerate}

  \item[7.] Заполните табличку и поясните (особенно строчки 4 и 7):
    $$
    \begin{array}{|cc|c|c|c|c|c|}
      \hline
      A & B & \O & o & \Theta & \omega & \Omega \\
      \hline
      n & n^2 & + & + & - & - & - \\
      \log^k n & n^{\epsilon} & + & + & - & - & - \\
      n^k & c^n & + & + & - & - & - \\
      \sqrt{n} & n^{\sin n} & ? & ? & ? & ? & ? \\
      2^n & 2^{n \slash 2} & - & - & - & + & + \\
      n^{\log m} & m^{\log n} & + & - & + & - & + \\
      \log (n!) & \log(n^n) & + & - & + & - & + \\
      \hline
    \end{array}
    $$
    Здесь все буквы, кроме $n$, --- положительные константы.
    \begin{proof}
      Насколько я понял, тут подразумевается вот такое отношение $$A = rel(B),$$
      где
      $$rel \in \{\O, o, \Theta, \omega, \Omega\}.$$
      Рассмотрим все строчки по порядку:
      \begin{eqnarray}
        \lim\limits_{n \to \infty}{\dfrac{\log_{\alpha}^k n}{n^{\epsilon}}} = \lim\limits_{n \to \infty}{\dfrac{k\log_{\alpha}^{k-1} n}{n \cdot \ln \alpha \cdot \epsilon \cdot n^{\epsilon - 1}}} = \lim\limits_{n \to \infty}{\dfrac{k\log_{\alpha}^{k-1} n}{\ln \alpha \cdot \epsilon \cdot n^{\epsilon}}} = \ldots = \lim\limits_{n \to \infty}{\dfrac{C}{n^{\beta}}} = 0 \Rightarrow \\
        \log^k n = \O(n^{\epsilon}) \quad \text{или} \quad \log^k n = o(n^{\epsilon}).
      \end{eqnarray}
      По правилу Лопиталя:
      \begin{eqnarray}
        \lim\limits_{n \to \infty}{\dfrac{n^k}{c^n}} = \lim\limits_{n \to \infty}{\dfrac{k\cdot n^{k-1}}{\log c \cdot c^n}} = \ldots = \lim\limits_{n \to \infty}{\dfrac{const}{c^n}} = 0 \Rightarrow \\
        n^k = \O(c^n) \quad \text{или} \quad n^k = o(c^n).
      \end{eqnarray}
      \begin{eqnarray}
        \lim\limits_{n \to \infty}{\dfrac{\sqrt{n}}{n^{\sin n}}} = ?,
      \end{eqnarray}
      потому что не понятно, к чему стремится синус\dots Если бы считался интеграл, то стремление было бы к нулю, но тут не интеграл, а значение\dots

      Применим правило степеней:
      \begin{eqnarray}
        \lim\limits_{n \to \infty}{\dfrac{2^n}{2^{n/2}}} = \lim\limits_{n \to \infty}{2^{n/2}} = \infty \Rightarrow \\
        2^n = \omega(2^{n/2}) \quad \text{или} \quad 2^n = \Omega(2^{n/2}).
      \end{eqnarray}
      Здесь $n$ и $m$ можно поменять местами:
      \begin{eqnarray}
        \lim\limits_{n \to \infty}{\dfrac{n^{\log m}}{m^{\log n}}} = \lim\limits_{n \to \infty}{\dfrac{m^{\log n}}{m^{\log n}}} = 1 \Rightarrow \\
        n^{\log m} = \O(m^{\log n}) \quad \text{или} \quad n^{\log m} = \Theta(m^{\log n}) \quad \text{или} \quad n^{\log m} = \Omega(m^{\log n}).
      \end{eqnarray}
      Из-за монотонности можно убрать логарифм и воспользоваться формулой Стирлинга:
      \begin{eqnarray}
        \lim\limits_{n \to \infty}{\dfrac{\log (n!)}{\log (n^n)}} = \lim\limits_{n \to \infty}{\dfrac{n!}{n^n}} = \lim\limits_{n \to \infty}{\dfrac{const\cdot n^n}{n^n}} = const \Rightarrow \\
        \log (n!) = \O(n^n) \quad \text{или} \quad \log (n!) = \Theta(n^n) \quad \text{или} \quad \log (n!) = \Omega(n^n).
      \end{eqnarray}
    \end{proof}

\end{enumerate}

\clearpage
