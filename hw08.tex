\section{Архидемоническое программирование}

% \subsection{Практика}
% \begin{enumerate}

%   \item
% 	Дан выпуклый $n$-угольник. Каждая диагональ $n$-угольника,
% 	соединяющая вершины $i$ и $j$, имеет вес $w_{ij}$. Вес
% 	триангуляции многоугольника есть сумма весов диагоналей, которые
% 	в ней проведены. Найти триангуляцию с минимальным весом за
% 	$\O(n^3)$.

%   \item
%     Найти максимальное по весу паросочетание за $\O(n)$ на
%     \begin{enumerate}
% 	  \item дереве из $n$ вершин,
% 	  \item простом цикле из $n$ вершин,
%       \item связном неориентированном графе из $n$ вершин и $n$ рёбер.
%     \end{enumerate}
%     Веса на рёбрах.

%   \item
%     Судно атакуют пираты. Для каждого пирата известны его азимут $a_i$
%     и время $t_i$, через которое пират приплывет и совершит
%     непотребство. Однако, у судна есть лазерная пушка, которой оно
%     защищается. У пушки есть начальный азимут $a$ и угловая скорость
%     вращения $\omega$. Пушка уничтожает все объекты, на которые она
%     сейчас направлена. Помогите судну определить порядок уничтожения
%     пиратов за $\O(n^2)$, чтобы не допустить непотребства.

%   \item
% 	Пусть дан взвешенный орграф на $n$ вершинах, $n \le w$ ($w$ --- разрядность машинного слова).
% 	\begin{enumerate}
% 	  \item Найдите кратчайший гамильтонов путь за $\O(n^2 2^n)$.
% 	  \item Найдите кратчайший гамильтонов цикл за $\O(n^2 2^n)$.
% 	  \item Проверьте существование гамильтонова пути за $\O(n 2^n)$.
% 	\end{enumerate}

%   \item
%     Посчитайте количество простых циклов в неорграфе за $\O(n^2 2^n)$.

%   \item
%     Есть $k$ грузовиков с заданной вместимостью, задача -- перевезти
%     $n$ вещей с заданными весами минимальным числом заездов. Один
%     заезд -- погрузить и отправить все грузовики.
%     \begin{enumerate}
%       \item $k=1$, $\O(3^n)$.
%       \item $k=2$, $\O(4^n)$.
%       \item $\O(3^nk)$.
%     \end{enumerate}    

%   \item
%     Вычислите, сколькими способами можно замостить доминошками
%     клетчатое поле
%     \begin{enumerate}
%       \item $n \times 3$, за время $\O(n)$.
%       \item $n \times m$, за время  $\O(4^nm)$.
%       \item $n \times m$, за время  $\O(2^nnm)$.
%     \end{enumerate}
%     Ответ посчитать по модулю небольшого простого числа.

%   \item
%     Клетки поля $n \times 5$ покрашены в чёрный и белый цвета. Будем
%     называть получившийся узор красивым, если он не содержит
%     одноцветного квадрата $2 \times 2$. Вычислите число красивых узоров
%     по модулю небольшого простого числа за время $\O(\log n)$.

% \end{enumerate}    
% \newpage

\subsection{Домашнее задание}
\begin{enumerate}
  \item \exceptgroup{Мишунина}
    Судно атакуют пираты. Для каждого пирата известны его азимут $a_i$
    и время $t_i$, через которое пират приплывет и совершит
    непотребство. Однако, у судна есть лазерная пушка, которой оно
    защищается. У пушки есть начальный азимут $a$ и угловая скорость
    вращения $\omega$. Пушка уничтожает все объекты, на которые она
    сейчас направлена. Помогите судну определить порядок уничтожения
    пиратов за $\O(n^2)$, чтобы не допустить непотребства.
  \begin{solution}
    Решим данную задачу динамикой. Будем в $M_L[l][r]$ хранить минимальное время, которое потребуется для того, чтобы покрыть лазером участок $[l, r]$, причем в конце данного действия лазер будет находиться в положении $l$ -- т.е. локально последним будет убит пират на позиции $l$. В $M_R[l][r]$ будем хранить минимальное время, которое потребуется для того, чтобы покрыть лазером участок $[l, r]$, причем в конце данного действия лазер будет находиться в положении $r$ -- т.е. локально последним будет убит пират на позиции $r$.
    
    Поймем как считать время: даны две какие-то координаты (угла) $\{a_i, a_j\}$; дана скорость поворота лазера $\omega$, тогда время можно посчитать по формуле:
    \begin{equation}
      time = \dfrac{|a_i-a_j|}{\omega}.
    \end{equation}
    Можно заполнить базовые случаи: нулевую колонку и последнюю строчку матрицы $M_L$ ($M_R$ заполняется аналогично). Нулевая колонка соответствует временам, которые потребуются для того, чтобы зачистить промежутки от $l_i$ до $r=0$, чтобы лазер оставался в $l_i$:
    \begin{equation}
      M_L[i][0] = \dfrac{|a[0]-a[i]|}{\omega}.
    \end{equation}
    Последня строчка соответствует временам, которые потребуются для того, чтобы зачистить промежутки от $l=n-1$ до $r_i$, чтобы лазер оставался в $l=n-1$:
    \begin{equation}
      M_L[n-1][j] = \dfrac{|a[n]-a[j]|}{\omega}.
    \end{equation}
    Запишем переходы. Чтобы увеличить правую границу на единицу, нужно взять решение для текущего промежутка и добавить время от начала текущего промежутка до границы плюс 1, и вернуться в левую позицию:
    \begin{equation}
      M_L[l][r+1] = M_R[l][r] + \dfrac{|a[r+1] - a[r]|}{\omega} + \dfrac{|a[r+1] - a[l]|}{\omega}.
    \end{equation}
    Чтобы уменьшить левую границу, нужно взять решение для текущего промежутка и добавить время от крайнего правого до нового левого:
    \begin{equation}
      M_L[l-1][r] = M_R[l][r] + \dfrac{|a[r]-a[l-1]|}{\omega}.
    \end{equation}
    Для $M_R$ переходы формируются аналогично:
    \begin{equation}
      \begin{cases}
        M_R[l][r+1] = M_L[l][r] + \dfrac{|a[r+1] - a[l]|}{\omega}, \\
        M_R[l-1][r] = M_L[l][r] + \dfrac{|a[r]-a[l-1]|}{\omega} + \dfrac{|a[l]-a[l-1]|}{\omega}.
      \end{cases}
    \end{equation}
    Соответственно, мы представили задачи в виде двумерных матриц, в которых заполнены левые колонки и нижние строчки, а также мы записали переходы для увеличения координаты $r$ и уменьшения координаты $l$, то есть заполнение таблиц будет происходить из левого нижнего угла. Две двумерных таблицы заполняются за $\O(n^2)$, и ответ будет лежать в правой верхней ячейке $M_L[0][n-1]$ или $M_R[0][n-1]$ в зависимости от величины результата (берем меньший).
    
    Самое время вспомнить про то, что лазер в начальный момент направлен на азимут $a$, поэтому перед выполнением алгоритма отсортируем точки $a_i$ так, чтобы $a$ лежал в отрезке $[a_0, a_1]$. После этого запустим алгоритм и учтем, что начальное положение лазера в общем случае не совпадает с положением первого пирата. Еще нужно сказать, что в конце ответ нужно сравнить со временем самого позднего пирата, и если ответ больше, то получается, что мы не можем помешать пиратам совершить непотребство.
  \end{solution}
    
    % \item \exceptgroup{Крыштаповича}
  %   Дана строка из латинских букв длины $n$, нужно ее за $\O(n^3)$ запаковать в максимально короткую, используя правило
  %   $n(S) = \underbrace{SS{\dots}S}_{n}$. \\ Например \texttt{UNIXYESYESYESUNIXYESYESYES} $\rightarrow$ \texttt{2(UNIX3(YES))}.

  \item[3.]
    Дан циклический массив, перед $i$-м идёт элемент $(i{-}1) \bmod n$,
    после $i$-го идёт $(i{+}1) \bmod n$. \\
    Рассмотрим операцию \texttt{zero(i) \{ ans += a[next(i)]*a[i]*a[prev(i)]; a[i] = 0 \}}\\
    Найти последовательность операций, максимизирующую \texttt{ans}.
    \begin{enumerate}
      \item $\O(n^3)$.
      \item $\O(n)$.
      \begin{solution}
        Дан циклический массив. Нужно понять, что если мы берем текущий элемент, то он обнуляется и операция $zero$ на предыдущем и на следующем элементах не будет увеличивать $ans$, то произведение будет нулевым.

        Для определения последовательности операций $zero(i)$ найдем индексы элементов, которые будут участвовать в искомой последовательности. Для $i$-го элемента можем сделать не более $n/2$ операций. Массив циклический и поэтому необходимо отдельно рассматреть случаи, когда мы одновременно рассматриваем первый элемент, и не рассматриваем последний, также когда рассматриваем последний, но не рассматриваем первый. Заведем для этого два массива $dp_1$ и $dp_2$, в которых будем постепенно накапливать максимально возможную сумму. Инициализируем сначала нулями, и переход будет:
        \begin{equation}
          \begin{cases}
            dp_1[i] = \max(dp_1[i-1], dp_1[i-2] + a[i]) \\
            dp_2[i] = \max(dp_2[i-1], dp_2[i-2])
          \end{cases}
        \end{equation}
      \end{solution}
      Из полученных массивов возьмем последние элементы и в качестве ответа возьмем максимум из них.
    \end{enumerate}

  \item[4.]
    Даны $n$ предметов. У каждого есть цена $v_i$ и вес $w_i$. Каждый предмет можно взять
    от $0$ до $k_i$ раз. Найти максимальную суммарную цену,
    которую можно набрать таким образом, чтобы суммарный вес не превышал $W$.
    $\O(nW)$ времени, $\O(W)$ памяти.

  \item[5.] \onlygroup{Крыштаповича}
    В Галлии есть $n$ деревень, некоторые из которых соединены дорогами, длины которых --
    натуральные числа. Известно, что от каждой деревни до любой другой можно добраться
    единственным способом. Астерикс и Обеликс решили устроить праздничный забег в честь
    очередной победы над подразделением Цезаря. Они хотят, чтобы забег начинался и заканчивался
    в деревнях, маршрут не проходил ни по какой деревне дважды и имел длину ровно $m$.
    Помогите им посчитать количество различных возможных маршрутов за $\O(nm)$.
    \begin{solution}
      Решим задачу динамикой. Возьмем какую-нибудь конкретную деревню, например первую, из которой будем стартовать забеги. Будем заполнять матрицу $M[i][j]$ - количество различных маршрутов от первой деревни до деревни $i$ длины $j$.

      Базовый случай: $M[i][0]=1$ для всех $i$ -- единственный способ добраться до любой деревни с длиной маршрута 0 - это остаться в той же деревне.
      Переход:
      \begin{equation}
        M[i][j] = \sum_{k=1}{n} M[k][j-\delta_{ik},]
      \end{equation}
      где $\delta_{ik}$ -- расстояние между деревнями $i, k$. Такие расстояние можно предпосчитать.
    \end{solution}

  \item[6.]
    Найдите во взвешенном графе гамильтонов цикл
    минимального веса, который удовлетворяет дополнительно следующему свойству: сначала
    номера посещенных вершин возрастают, а затем убывают. Время $\O(n^2)$.

% \subsection*{Дополнительные задачи}
%  \item 
%     Есть мешок с n камнями с массами $w_i$. Суммарный вес камней равен $W$. Известно, что если столкнуть два камня $i, j$ с весами $w_i \geq w_j$, то они уничтожатся, а на их месте останется камень-осколок весом $w_i - w_j$. Разрешается в произвольном порядке сталкивать по два камня, возвращая результаты столкновений обратно в мешок, до тех пор, пока останется не более одного камня. Определите минимальный возможный вес мешка в конце. $\O(nW)$.

%   \item
% 	Найти максимальное по весу паросочетание на кактусе за
% 	$\O(n)$. Кактус --- граф, в котором каждое ребро лежит не более чем
% 	на одном простом цикле.

%   \item
% 	Есть $n$ вещей, у каждой есть стоимость $v_i$ и вес $w_i$. Есть рюкзак, в
% 	котором можно унести набор вещей суммарного веса не более $W$ 
% 	за один подход. За $m = 2^k$ подходов унести вещи максимальной суммарной стоимости.
% 	Время $\O(3^nk)$.

%   \item 
% 	Вам дана доска фанеры размера $n \times m$. В нее было вбито
%     несколько гвоздей с целыми координатами (от них остались некрасивые
% 	дырки). Сколькими способами можно разрезать доску на прямоугольники
% 	с целыми сторонами так, чтобы ни один из гвоздей не попал внутрь
% 	прямоугольника. Время: $\O(n^2 4^m)$.

%   \item
%  	Найти минимальный шаблон такой, что под него не подходит первая строка,
%  	но при этом подходит вторая. $\O(n^3)$.

\end{enumerate}

